$(function(){var a=$("#webpad"),g=$("#char-count").find("span"),c=$("#sidebar"),d=$("#history"),e=$("#footer"),f=$("#share-dialog");f.dialog({autoOpen:!1,modal:!0,resizable:!1,draggable:!1,width:315});a.on("resizeWebNoted",function(){a.height($(window).height()-e.height()-88);a.width($(window).width()-298)}).on("wnShareLinkGenerated",function(){var b=a.webNoted("getSharedUrl");f.find(".tweet-link").html('<a href="https://twitter.com/share" class="twitter-share-button" data-url="'+b+'" data-text="I shared a note:" data-count="none" data-hashtags="webnoted"></a>').end().find("#success").show().end().find("#processing").hide().end().find("#error").hide().end().find("#shared-url").attr("readonly", !1).val(b).attr("readonly",!0).click(function(){this.select()}).select();void 0!==typeof twttr&&twttr.widgets.load()}).on("wnShareLinkError",function(){f.find("#error").show().end().find("#success").hide().end().find("#processing").hide()}).on("wnContentChanged",function(){setTimeout(function(){g.html(a.webNoted("count"))},0)}).on("wnNoteRenamed wnNoteCreated wnReady",function(){buildHistory(a.webNoted("getSavedNotes"),a.webNoted("getCurrentDocument"),d)}).on("wnNoteDeleted",function(){buildHistory(a.webNoted("getSavedNotes"), a.webNoted("getCurrentDocument"),d);a.webNoted("canSave",!1);d.trigger("change");a.webNoted("canSave",!0)}).on("wnEdited",function(){window.location="/"}).on("wnNoStorage",function(){window.location="http://www.whatbrowser.org/"}).webNoted({apiURL:"/php/share.php"}).trigger("resizeWebNoted").trigger("contentChanged");d.on("change",function(b){b=$(b.target).find(":selected").text();a.webNoted("switchDocument",b)});c.find(".jsManageContents").click(function(){var b=$(this),d=$("#status-message"),c= "",b=b.attr("id");"create"===b?c="New note created":"save"===b?c="Contents saved":"clear"===b?c="Contents cleared":"share"===b&&(c="Generating Link",f.dialog("open").find("#processing").show().end().find("#success").hide().end().find("#error").hide());a.webNoted(b);d.text(c).show("fast");setTimeout(function(){d.hide("fast")},1E3)});$(window).resize(function(){a.trigger("resizeWebNoted")}).on("blur unload",function(){a.webNoted("save")});$.getScript("//platform.twitter.com/widgets.js")}); function buildHistory(a,g,c){c.html("");$.each(a,function(a,e){a+=1;c.append('<option value="'+a+'">'+e.substring(5)+"</option>");g===e&&c.val(a).attr("selected",!0)})};